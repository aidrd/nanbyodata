<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <h1>
      <a class="navbar-brand js-scroll-trigger" href="/">
        <img class="imgtitle" src="/static/img/NanbyoData_black_w.svg" alt="NanbyoDataロゴ">
      </a>
    </h1>
    <div class="flex-wrapper">
      <div class="flex">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
          data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
          aria-label="Toggle navigation" onclick="toggleNavMenu()">
          <i class=" fas fa-bars"></i>
        </button>
        <select class="language-select">
          <option value="ja" {% if get_locale()=='ja' %}selected{% endif %}>日本語</option>
          <option value="en" {% if get_locale()=='en' %}selected{% endif %}>English</option>
        </select>
      </div>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/about_nando">ABOUT</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" href="javascript:void(0);" onclick="toggleDropdown()">
              DATA <i id="dropdownIcon" class="fas fa-angle-down"></i>
            </a>
            <ul class="dropdown-menu" id="dropdownMenu" style="display: none;">
              <li><a class="dropdown-item" href="/api">API</a></li>
              <li><a class="dropdown-item" href="/#download">DOWNLOAD</a></li>
              <li><a class="dropdown-item" href="/datasets">DATASETS</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/epidemiology">EPIDEMIOLOGY</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#"><button type="button" class="btn-TOS" data-toggle="modal"
                data-target="#demoNormalModal_TOS">TERMS</button></a>
          </li>
          <li class="nav-item">
            {% if get_locale() == "ja" or get_locale() == "ja_JP" %}
            <a class="nav-link" title="Comments & suggestions are welcome!"
              href="https://dbcls.rois.ac.jp/contact.html">CONTACT</a>
            {% else %}
            <a class="nav-link" title="Comments & suggestions are welcome!"
              href="https://dbcls.rois.ac.jp/contact-en.html">CONTACT</a>
            {% endif %}
          </li>
        </ul>
      </div>
    </div>
  </div>
</nav>

<style>
  .dropdown-menu {
    position: absolute;
    background-color: var(--color-primary);
    padding: 10px;
    border-radius: 0;
    border: 1px solid white;
    list-style: none;
    top: 25px;

    li {
      margin: 0;
      padding: 5px 0;

      .dropdown-item {
        color: white;
        text-decoration: none;

        &:hover {
          color: var(--color-nav-hover);
          background-color: var(--color-primary);
        }
      }
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const dropdown = document.getElementById("dropdownMenu");
    const icon = document.getElementById("dropdownIcon");

    function toggleDropdown() {
      if (dropdown.style.display === "none") {
        dropdown.style.display = "block";
        icon.classList.remove("fa-angle-down");
        icon.classList.add("fa-angle-up");
      } else {
        dropdown.style.display = "none";
        icon.classList.remove("fa-angle-up");
        icon.classList.add("fa-angle-down");
      }
    }

    document.querySelector(".nav-link[href='javascript:void(0);']").addEventListener("click", toggleDropdown);

    document.addEventListener("click", function (event) {
      if (!event.target.closest(".dropdown") && dropdown.style.display === "block") {
        dropdown.style.display = "none";
        icon.classList.remove("fa-angle-up");
        icon.classList.add("fa-angle-down");
      }
    });

    const dropdownItems = document.querySelectorAll("#dropdownMenu .dropdown-item");
    dropdownItems.forEach(item => {
      item.addEventListener("click", () => {
        dropdown.style.display = "none";
        icon.classList.remove("fa-angle-up");
        icon.classList.add("fa-angle-down");
      });
    });
  });


</script>
